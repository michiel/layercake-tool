digraph G {
    {{#with config.target_options.graphviz as |gv|}}
    layout="{{gv.layout}}";
    {{/with}}
    {{#if graph_name}}
    label="{{graph_name}}";
    {{/if}}
    rankdir="{{config.orientation}}";
    {{#with config.target_options.graphviz as |gv|}}
    splines={{gv.splines}};
    overlap={{gv.overlap}};
    nodesep="{{gv.nodesep}}";
    ranksep="{{gv.ranksep}}";
    {{else}}
    splines=true;
    overlap=false;
    nodesep="0.3";
    ranksep="1.3";
    {{/with}}
    labelloc="t";
    {{#if (stringeq config.built_in_styles "dark")}}
    bgcolor="#1e1e1e";
    fontcolor="#f5f5f5";
    node [ shape="plaintext" style="filled, rounded" fontsize=12 fontname="Lato" fillcolor="#2b2b2b" fontcolor="#f5f5f5" color="#666666" ]
    edge [ fontname="Lato" color="#dfe3ec" fontsize=8]
    {{else}}
        {{#if (stringeq config.built_in_styles "none")}}
        node [ shape="box" fontsize=11 ]
        edge [ fontsize=8 ]
        {{else}}
        bgcolor="#ffffff";
        fontcolor="#1f2933";
        node [ shape="box" style="rounded,filled" fontsize=12 fontname="Lato" fillcolor="#f7f7f8" fontcolor="#0f172a" color="#1f2933" penwidth=1.2 ]
        edge [ fontname="Lato" color="#2B303A" fontsize=8]
        {{/if}}
    {{/if}}
    {{#if (eq config.orientation "LR")}}
    node [ width=1.5, fixedsize=false ]
    {{/if}}

{{#if config.contain_nodes}}
  {{#each hierarchy_tree as |rootnode|}}
{{{dot_render_tree rootnode ../layer_map ../config}}}
  {{/each}}
{{else}}
  {{#if config.apply_layers}}
    {{#each layers as |layer|}}
  node [style="filled,rounded" fillcolor="#{{layer.background_color}}" fontcolor="#{{layer.text_color}}" penwidth=1 color="#{{layer.border_color}}"]; {
        {{#each ../flow_nodes as |node|}}
          {{#if (eq node.layer layer.id)}}
              {{node.id}}[label="{{node.label}}"{{#if (and ../../config.add_node_comments_as_notes (exists node.comment))}}{{#if (stringeq ../../config.target_options.graphviz.comment_style "tooltip")}}, tooltip="{{node.comment}}"{{else}}, xlabel="{{node.comment}}"{{/if}}{{/if}}];
          {{/if}}
        {{/each}}
      }
    {{/each}}
  {{else}}
    {{#each flow_nodes as |node|}}
      {{node.id}}[label="{{node.label}}", style="rounded"{{#if (and ../config.add_node_comments_as_notes (exists node.comment))}}{{#if (stringeq ../config.target_options.graphviz.comment_style "tooltip")}}, tooltip="{{node.comment}}"{{else}}, xlabel="{{node.comment}}"{{/if}}{{/if}}];
    {{/each}}
  {{/if}}
{{/if}}

  {{#each flow_edges as |edge|}}
    {{#if (exists edge.label)}}
      {{edge.source}} -> {{edge.target}} [label="{{edge.label}}" {{#if ../config.apply_layers}}{{#each layer in ../layers}} {{#if (eq edge.layer layer.id)}} fontcolor="#{{layer.background_color}}" {{/if}} {{/each}}{{/if}}{{#if ../config.use_edge_weight}} penwidth={{edge_penwidth edge.weight}}{{/if}}];
    {{else}}
      {{edge.source}} -> {{edge.target}}{{#if ../config.use_edge_weight}} [penwidth={{edge_penwidth edge.weight}}]{{/if}};
    {{/if}}
  {{/each}}
}
